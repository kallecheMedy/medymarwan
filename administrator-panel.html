<!DOCTYPE html>
<html>
<head>
    <link href="/resources/labheader/css/academyLabHeader.css" rel="stylesheet">
    <link href="/resources/css/labs.css" rel="stylesheet">
    <title>User ID controlled by request parameter with password disclosure</title>
</head>
<body>
    <script src="/resources/labheader/js/labHeader.js"></script>
    <div id="academyLabHeader">
        <section class="academyLabBanner">
            <div class="container">
                <div class="logo"></div>
                <div class="title-container">
                    <h2>User ID controlled by request parameter with password disclosure</h2>
                    <a class="link-back" href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-password-disclosure">
                        Back&nbsp;to&nbsp;lab&nbsp;description&nbsp;
                        <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 28 30" enable-background="new 0 0 28 30" xml:space="preserve" title="back-arrow">
                            <g>
                                <polygon points="1.4,0 0,1.2 12.6,15 0,28.8 1.4,30 15.1,15"></polygon>
                                <polygon points="14.3,0 12.9,1.2 25.6,15 12.9,28.8 14.3,30 28,15"></polygon>
                            </g>
                        </svg>
                    </a>
                </div>
                <div class="widgetcontainer-lab-status is-notsolved">
                    <span>LAB</span>
                    <p>Not solved</p>
                    <span class="lab-status-icon"></span>
                </div>
            </div>
        </section>
    </div>
    
    <div theme="">
        <section class="maincontainer">
            <div class="container is-page">
                <header class="navigation-header">
                    <section class="top-links">
                        <a href="/">Home</a><p>|</p>
                        <a href="/admin">Admin panel</a><p>|</p>
                        <a href="/my-account?id=administrator">My account</a><p>|</p>
                    </section>
                </header>
                <header class="notification-header">
                </header>
                <section>
                    <h1>Users</h1>
                    <div>
                        <span>wiener - </span>
                        <a href="/admin/delete?username=wiener">Delete</a>
                    </div>
                    <div>
                        <span>carlos - </span>
                        <a href="/admin/delete?username=carlos">Delete</a>
                    </div>
                </section>
                <br>
                <hr>
            </div>
        </section>
        <div class="footer-wrapper">
        </div>
    </div>

    <script>
        // Code pour WebSocket
        let completedListeners = [];

        (function () {
            let labHeaderWebSocket = undefined;
            function openWebSocket() {
                return new Promise(res => {
                    if (labHeaderWebSocket) {
                        res(labHeaderWebSocket);
                        return;
                    }

                    let newWebSocket = new WebSocket(location.origin.replace("http", "ws") + "/academyLabHeader");

                    newWebSocket.onopen = function (evt) {
                        res(newWebSocket);
                    };

                    newWebSocket.onmessage = function (evt) {
                        const labSolved = document.getElementById('notification-labsolved');
                        const keepAliveMsg = evt.data === 'PONG';
                        if (labSolved || keepAliveMsg) {
                            return;
                        }
                        document.getElementById("academyLabHeader").innerHTML = evt.data;
                        animateLabHeader();

                        for (const listener of completedListeners) {
                            listener();
                        }
                    };

                    setInterval(() => {
                        newWebSocket.send("PING");
                    }, 5000);
                });
            }

            labHeaderWebSocket = openWebSocket();
        })();

        function animateLabHeader() {
            setTimeout(function() {
                const labSolved = document.getElementById('notification-labsolved');
                if (labSolved) {
                    let cl = labSolved.classList;
                    cl.remove('notification-labsolved-hidden');
                    cl.add('notification-labsolved');
                }
            }, 500);
        }
    </script>
</body>
</html>
